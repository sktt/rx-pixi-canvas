!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n(require("rx"),require("pixi.js")):"function"==typeof define&&define.amd?define(["rx","pixi.js"],n):e.canvasRenderer=n(e.Rx,e.PIXI)}(this,function(e,n){"use strict";n="default"in n?n["default"]:n;var t={},o={};t.resources=function(n,t){return Object.keys(t).length?(Object.keys(t).reduce(function(e,n){return e.add(n,t[n])},n),e.Observable.fromCallback(n.load,n,function(e,n){return n})()):e.Observable.just({})},o.domReady=e.Observable.merge(e.Observable.just(),e.Observable.fromEvent(document,"readystatechange")).map(function(e){return document.readyState}).filter(function(e){return"complete"===e}).take(1),o.resize=e.Observable.merge(e.Observable.just(),e.Observable.fromEvent(window,"resize")).map(function(e){return[window.innerWidth,window.innerHeight]}).publishValue([window.innerWidth,window.innerHeight]),o.domRoot=o.domReady.flatMap(function(n){return e.Observable.just(document.body).map(function(e){return e.style.backgroundColor="#000",e.style.display="flex",e.style.justifyContent="center",e.style.height="100%",e.style.margin="0",e.style.flexDirection="column",e.parentNode.style.height="100%",e})}).take(1).publish();var r=function(e){return function(n){var t=Math.max(0,n-e);return e=n,t}};o.tick=e.Observable.create(function(e){var n=void 0,t=function(o){n&&(n=window.requestAnimationFrame(t)),e.onNext(o)};return n=window.requestAnimationFrame(t),function(){if(n){var e=n;n=void 0,window.cancelAnimationFrame(e)}}}).map(r(performance.now())).publish();var i={create:t,obs:o},s=function(e){var t=function(t){var o=new n.WebGLRenderer(e.size.x,e.size.y,{antialias:!0});return o.plugins.interaction.destroy(),delete o.plugins.interaction,o}();return i.obs.domRoot.subscribe(function(e){e.appendChild(t.view)}),i.obs.resize.subscribe(function(n){var o=n[0];n[1];t.view.style.height=e.size.y*(o/e.size.x)+"px"}),console.info("connect: obs.domRoot"),i.obs.domRoot.connect(),console.info("connect: obs.resize"),i.obs.resize.connect(),console.info("connect: obs.tick"),i.obs.tick.connect(),t},a={common:i,renderer:s};return a});